import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.e4a1f2a7.js";const C=JSON.parse('{"title":"Base Controller","description":"","frontmatter":{},"headers":[],"relativePath":"base-controller.md","filePath":"base-controller.md","lastUpdated":1702863698000}'),o={name:"base-controller.md"},p=l(`<h1 id="base-controller" tabindex="-1">Base Controller <a class="header-anchor" href="#base-controller" aria-label="Permalink to &quot;Base Controller&quot;">​</a></h1><p>Base Controller adalah class yang berfungsi untuk mengatur class controller lainnya. Class ini berisi method-method yang dapat digunakan oleh class controller lainnya. Dengan menggunakan base controller, maka class controller lainnya dapat mengakses method yang terdapat pada base controller. Kita akan membuat base controller dengan nama <code>BaseController.cs</code> pada folder <code>Controllers</code>.</p><h2 id="membuat-base-controller" tabindex="-1">Membuat Base Controller <a class="header-anchor" href="#membuat-base-controller" aria-label="Permalink to &quot;Membuat Base Controller&quot;">​</a></h2><p>Tambahkan kode berikut pada <code>BaseController.cs</code>:</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">System</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Collections</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Generic</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">System</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Data</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">System</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Linq</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MySql</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Data</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">MySqlClient</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">using</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">System</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Windows</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Forms</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">namespace</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">project_akhir</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Controllers</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">BaseController</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">table</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Config</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Connection</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">_connection</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Config.Connection.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DataTable</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ShowAll</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">DataTable</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">_data</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DataTable</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Open</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">MySqlDataReader</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">data</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (query </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            {</span></span>
<span class="line"><span style="color:#E1E4E8;">                data </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _connection.</span><span style="color:#B392F0;">Query</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SELECT * FROM &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.table);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">            {</span></span>
<span class="line"><span style="color:#E1E4E8;">                data </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _connection.</span><span style="color:#B392F0;">Query</span><span style="color:#E1E4E8;">(query);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            _data.</span><span style="color:#B392F0;">Load</span><span style="color:#E1E4E8;">(data);</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> _data;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Create</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">IDictionary</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">object</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        {</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Open</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">MySqlCommand</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">_command</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">CreateCommand</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fields</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;, &quot;</span><span style="color:#E1E4E8;">, request.Keys);</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">values</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;, &quot;</span><span style="color:#E1E4E8;">, request.Keys.</span><span style="color:#B392F0;">Select</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;@&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> key));</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sql</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;INSERT INTO &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.table </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; (&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> fields </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;) VALUES (&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> values </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;)&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">            _command.CommandText </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sql;</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">foreach</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">kvp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> request)</span></span>
<span class="line"><span style="color:#E1E4E8;">            {</span></span>
<span class="line"><span style="color:#E1E4E8;">                _command.Parameters.</span><span style="color:#B392F0;">AddWithValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;@&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> kvp.Key, kvp.Value);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            _command.</span><span style="color:#B392F0;">ExecuteNonQuery</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Update</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">IDictionary</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">object</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        {</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Open</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">MySqlCommand</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">_command</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">CreateCommand</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fields</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;, &quot;</span><span style="color:#E1E4E8;">, request.Keys.</span><span style="color:#B392F0;">Select</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> key </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; = @&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> key));</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sql</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;UPDATE &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.table </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; SET &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> fields </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; WHERE id = &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> id;</span></span>
<span class="line"><span style="color:#E1E4E8;">            _command.CommandText </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sql;</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">foreach</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">kvp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> request)</span></span>
<span class="line"><span style="color:#E1E4E8;">            {</span></span>
<span class="line"><span style="color:#E1E4E8;">                _command.Parameters.</span><span style="color:#B392F0;">AddWithValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;@&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> kvp.Key, kvp.Value);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            _command.</span><span style="color:#B392F0;">ExecuteNonQuery</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Delete</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(id </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            {</span></span>
<span class="line"><span style="color:#E1E4E8;">                MessageBox.</span><span style="color:#B392F0;">Show</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Pilih data yang akan dihapus&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Open</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">MySqlCommand</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">_command</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">CreateCommand</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sql</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;DELETE FROM &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.table </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; WHERE id = &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> id;</span></span>
<span class="line"><span style="color:#E1E4E8;">            _command.CommandText </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sql;</span></span>
<span class="line"><span style="color:#E1E4E8;">            _command.</span><span style="color:#B392F0;">ExecuteNonQuery</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">System</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Collections</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Generic</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">System</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Data</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">System</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Linq</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MySql</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Data</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">MySqlClient</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">using</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">System</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Windows</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Forms</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">namespace</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">project_akhir</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Controllers</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BaseController</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">table</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Config</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Connection</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">_connection</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Config.Connection.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DataTable</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ShowAll</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">query</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">DataTable</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">_data</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DataTable</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Open</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">MySqlDataReader</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">data</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (query </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> _connection.</span><span style="color:#6F42C1;">Query</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SELECT * FROM &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.table);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> _connection.</span><span style="color:#6F42C1;">Query</span><span style="color:#24292E;">(query);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            _data.</span><span style="color:#6F42C1;">Load</span><span style="color:#24292E;">(data);</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> _data;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Create</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">IDictionary</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">object</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Open</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">MySqlCommand</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">_command</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">CreateCommand</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fields</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">string</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;, &quot;</span><span style="color:#24292E;">, request.Keys);</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">values</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">string</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;, &quot;</span><span style="color:#24292E;">, request.Keys.</span><span style="color:#6F42C1;">Select</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> key));</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sql</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;INSERT INTO &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.table </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; (&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> fields </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;) VALUES (&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> values </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;)&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">            _command.CommandText </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sql;</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">foreach</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">kvp</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> request)</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                _command.Parameters.</span><span style="color:#6F42C1;">AddWithValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> kvp.Key, kvp.Value);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            _command.</span><span style="color:#6F42C1;">ExecuteNonQuery</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Update</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">IDictionary</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">object</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Open</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">MySqlCommand</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">_command</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">CreateCommand</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fields</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">string</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;, &quot;</span><span style="color:#24292E;">, request.Keys.</span><span style="color:#6F42C1;">Select</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> key </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; = @&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> key));</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sql</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;UPDATE &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.table </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; SET &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> fields </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; WHERE id = &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> id;</span></span>
<span class="line"><span style="color:#24292E;">            _command.CommandText </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sql;</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">foreach</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">kvp</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> request)</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                _command.Parameters.</span><span style="color:#6F42C1;">AddWithValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> kvp.Key, kvp.Value);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            _command.</span><span style="color:#6F42C1;">ExecuteNonQuery</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Delete</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(id </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            {</span></span>
<span class="line"><span style="color:#24292E;">                MessageBox.</span><span style="color:#6F42C1;">Show</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Pilih data yang akan dihapus&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Open</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">MySqlCommand</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">_command</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">CreateCommand</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sql</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;DELETE FROM &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.table </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; WHERE id = &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> id;</span></span>
<span class="line"><span style="color:#24292E;">            _command.CommandText </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sql;</span></span>
<span class="line"><span style="color:#24292E;">            _command.</span><span style="color:#6F42C1;">ExecuteNonQuery</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Keterangan kode di atas:</p><ul><li>public string table = &quot;&quot;; digunakan untuk menyimpan nama tabel yang akan digunakan.</li><li>private Config.Connection _connection = Config.Connection.getInstance(); digunakan untuk membuat objek dari class Connection.</li><li>public DataTable ShowAll(string query = &quot;&quot;) digunakan untuk menampilkan semua data dari tabel yang digunakan.</li><li>public void Create(IDictionary&lt;string, object&gt; request) digunakan untuk menambahkan data ke dalam tabel yang digunakan.</li><li>public void Update(int id, IDictionary&lt;string, object&gt; request) digunakan untuk mengubah data pada tabel yang digunakan.</li><li>public void Delete(int id) digunakan untuk menghapus data pada tabel yang digunakan.</li></ul><h2 id="base-controller-vs-basic-controller" tabindex="-1">Base Controller Vs Basic Controller <a class="header-anchor" href="#base-controller-vs-basic-controller" aria-label="Permalink to &quot;Base Controller Vs Basic Controller&quot;">​</a></h2><p>Base Controller dan Basic Controller memiliki perbedaan yang cukup signifikan. Perbedaan tersebut dapat dilihat pada kode berikut:</p><p>Base Controller:</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Create</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">IDictionary</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">object</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#B392F0;">request</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Open</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">MySqlCommand</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">_command</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">CreateCommand</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fields</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;, &quot;</span><span style="color:#E1E4E8;">, request.Keys);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">values</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;, &quot;</span><span style="color:#E1E4E8;">, request.Keys.</span><span style="color:#B392F0;">Select</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;@&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> key));</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sql</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;INSERT INTO &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.table </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; (&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> fields </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;) VALUES (&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> values </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;)&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    _command.CommandText </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sql;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">foreach</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">kvp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> request)</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        _command.Parameters.</span><span style="color:#B392F0;">AddWithValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;@&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> kvp.Key, kvp.Value);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    _command.</span><span style="color:#B392F0;">ExecuteNonQuery</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    _connection.</span><span style="color:#B392F0;">getConnection</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Create</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">IDictionary</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">object</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">request</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Open</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">MySqlCommand</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">_command</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">CreateCommand</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fields</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">string</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;, &quot;</span><span style="color:#24292E;">, request.Keys);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">values</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">string</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">Join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;, &quot;</span><span style="color:#24292E;">, request.Keys.</span><span style="color:#6F42C1;">Select</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> key));</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sql</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;INSERT INTO &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.table </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; (&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> fields </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;) VALUES (&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> values </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;)&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    _command.CommandText </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sql;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">foreach</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">kvp</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> request)</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        _command.Parameters.</span><span style="color:#6F42C1;">AddWithValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> kvp.Key, kvp.Value);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    _command.</span><span style="color:#6F42C1;">ExecuteNonQuery</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    _connection.</span><span style="color:#6F42C1;">getConnection</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Basic Controller:</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Create</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">Models</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">User</span><span style="color:#E1E4E8;">) </span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">MySqlCommand</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">command</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MySqlCommand</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        command.CommandText </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;INSERT INTO &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> _user.TableName </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; (name, email) VALUES (@name, @email)&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        command.Parameters.</span><span style="color:#B392F0;">AddWithValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;@name&quot;</span><span style="color:#E1E4E8;">, User.Name);</span></span>
<span class="line"><span style="color:#E1E4E8;">        command.Parameters.</span><span style="color:#B392F0;">AddWithValue</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;@email&quot;</span><span style="color:#E1E4E8;">, User.Email);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.Connection.</span><span style="color:#B392F0;">Open</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        command.Connection </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.Connection;</span></span>
<span class="line"><span style="color:#E1E4E8;">        command.</span><span style="color:#B392F0;">ExecuteNonQuery</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.Connection.</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">Exception</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        MessageBox.</span><span style="color:#B392F0;">Show</span><span style="color:#E1E4E8;">(e.Message);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Create</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">Models</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">User</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">User</span><span style="color:#24292E;">) </span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">MySqlCommand</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">command</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MySqlCommand</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        command.CommandText </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;INSERT INTO &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> _user.TableName </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; (name, email) VALUES (@name, @email)&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        command.Parameters.</span><span style="color:#6F42C1;">AddWithValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@name&quot;</span><span style="color:#24292E;">, User.Name);</span></span>
<span class="line"><span style="color:#24292E;">        command.Parameters.</span><span style="color:#6F42C1;">AddWithValue</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@email&quot;</span><span style="color:#24292E;">, User.Email);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.Connection.</span><span style="color:#6F42C1;">Open</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        command.Connection </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.Connection;</span></span>
<span class="line"><span style="color:#24292E;">        command.</span><span style="color:#6F42C1;">ExecuteNonQuery</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.Connection.</span><span style="color:#6F42C1;">Close</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">Exception</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        MessageBox.</span><span style="color:#6F42C1;">Show</span><span style="color:#24292E;">(e.Message);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Dari kedua kode di atas dapat dilihat bahwa pada base controller, kita dapat menambahkan data ke dalam tabel dengan cara yang lebih mudah. Sedangkan pada basic controller, kita harus membuat query untuk menambahkan data ke dalam tabel. Kita dapat membayangkan ada 10 fitur yang membutuhkan query untuk menambahkan data ke dalam tabel. Jika menggunakan basic controller, maka kita harus membuat 10 query yang berbeda. Sedangkan jika menggunakan base controller, kita hanya perlu membuat 1 method untuk menambahkan data ke dalam tabel.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Jika diperhatikan, sebenarnya pada base controller terdapat method yang sama dengan basic controller. Hanya saja, pada base controller dibuatkan method yang lebih umum sehingga dapat digunakan oleh class controller lainnya serta pada setiap fungsi Query dibuat menjadi dinamis menggunakan bantuan parameter, string interpolation, dan perulangan.</p></div>`,15),e=[p];function t(c,r,E,y,i,F){return n(),a("div",null,e)}const d=s(o,[["render",t]]);export{C as __pageData,d as default};
